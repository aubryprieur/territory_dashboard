<!-- Comparaison des données enfants -->
<div class="bg-white shadow rounded-lg p-6 mb-6">
  <h2 class="text-lg font-medium text-gray-900 mb-4">Les enfants</h2>

  <!-- Tableau pour enfants de moins de 3 ans -->
  <div class="mb-8">
    <h3 class="text-sm font-medium text-gray-700 mb-4">Part des enfants de moins de 3 ans</h3>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Territoire
            </th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Part dans la population (%)
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <!-- Ligne pour la commune -->
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
              <%= @territory_name %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <% commune_rate = @children_data&.dig("under_3_rate") || 0 %>
              <%= number_to_percentage(commune_rate, precision: 2) %>
            </td>
          </tr>

          <!-- Ligne pour l'EPCI si disponible -->
          <% if @epci_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <%= @epci_revenue_data&.dig("name") || "EPCI" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% epci_rate = @epci_children_data["under_3_rate"] rescue 0 %>
                <%= number_to_percentage(epci_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour le département si disponible -->
          <% if @department_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                Département <%= @department_children_data["department"] rescue "" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% dept_rate = @department_children_data["under_3_rate"] rescue 0 %>
                <%= number_to_percentage(dept_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour la région si disponible -->
          <% if @region_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                Région <%= @region_children_data["region"] rescue "" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% region_rate = @region_children_data["under_3_rate"] rescue 0 %>
                <%= number_to_percentage(region_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour la France -->
          <% if @france_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
                France
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% france_rate = @france_children_data["under_3_rate"] rescue 0 %>
                <%= number_to_percentage(france_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Tableau pour enfants de 3 à 5 ans -->
  <div class="mb-8">
    <h3 class="text-sm font-medium text-gray-700 mb-4">Part des enfants de 3 à 5 ans</h3>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Territoire
            </th>
            <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Part dans la population (%)
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <!-- Ligne pour la commune -->
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
              <%= @territory_name %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <% commune_rate = @children_data&.dig("three_to_five_rate") || 0 %>
              <%= number_to_percentage(commune_rate, precision: 2) %>
            </td>
          </tr>

          <!-- Ligne pour l'EPCI si disponible -->
          <% if @epci_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <%= @epci_revenue_data&.dig("name") || "EPCI" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% epci_rate = @epci_children_data["three_to_five_rate"] rescue 0 %>
                <%= number_to_percentage(epci_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour le département si disponible -->
          <% if @department_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                Département <%= @department_children_data["department"] rescue "" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% dept_rate = @department_children_data["three_to_five_rate"] rescue 0 %>
                <%= number_to_percentage(dept_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour la région si disponible -->
          <% if @region_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                Région <%= @region_children_data["region"] rescue "" %>
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% region_rate = @region_children_data["three_to_five_rate"] rescue 0 %>
                <%= number_to_percentage(region_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>

          <!-- Ligne pour la France -->
          <% if @france_children_data.present? %>
            <tr>
              <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
                France
              </td>
              <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
                <% france_rate = @france_children_data["three_to_five_rate"] rescue 0 %>
                <%= number_to_percentage(france_rate, precision: 2) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

</div>
