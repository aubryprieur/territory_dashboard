<!-- app/views/dashboard/_employment.html.erb -->
<div class="bg-white shadow rounded-lg p-6 mb-6">
  <h2 class="text-lg font-medium text-gray-900 mb-4">L'emploi des femmes</h2>

  <div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Territoire
          </th>
          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Taux d'activité (15-64 ans)
          </th>
          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Taux d'emploi (15-64 ans)
          </th>
          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Taux de temps partiel (15-64 ans)
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <!-- Ligne pour la commune -->
        <tr>
          <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
            <%= @territory_name %>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
            <%= number_to_percentage(@employment_data&.dig("rates", "activity_rate") || 0, precision: 2) %>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
            <%= number_to_percentage(@employment_data&.dig("rates", "employment_rate") || 0, precision: 2) %>
          </td>
          <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
            <%= number_to_percentage(@employment_data&.dig("rates", "part_time_rate_15_64") || 0, precision: 2) %>
          </td>
        </tr>

        <!-- Ligne pour l'EPCI si disponible -->
        <% if @epci_employment_data.present? %>
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= @epci_employment_data&.dig("name") || "EPCI" %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@epci_employment_data&.dig("rates", "activity_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@epci_employment_data&.dig("rates", "employment_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@epci_employment_data&.dig("rates", "part_time_rate_15_64") || 0, precision: 2) %>
            </td>
          </tr>
        <% end %>

        <!-- Ligne pour le département si disponible -->
        <% if @department_employment_data.present? %>
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= @department_employment_data&.dig("name") || "Département" %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@department_employment_data&.dig("rates", "activity_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@department_employment_data&.dig("rates", "employment_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@department_employment_data&.dig("rates", "part_time_rate_15_64") || 0, precision: 2) %>
            </td>
          </tr>
        <% end %>

        <!-- Ligne pour la région si disponible -->
        <% if @region_employment_data.present? %>
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= @region_employment_data&.dig("name") || "Région" %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@region_employment_data&.dig("rates", "activity_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@region_employment_data&.dig("rates", "employment_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@region_employment_data&.dig("rates", "part_time_rate_15_64") || 0, precision: 2) %>
            </td>
          </tr>
        <% end %>

        <!-- Ligne pour la France -->
        <% if @france_employment_data.present? %>
          <tr>
            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">
              France
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@france_employment_data&.dig("rates", "activity_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@france_employment_data&.dig("rates", "employment_rate") || 0, precision: 2) %>
            </td>
            <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">
              <%= number_to_percentage(@france_employment_data&.dig("rates", "part_time_rate_15_64") || 0, precision: 2) %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <!-- Légende explicative -->
  <div class="mt-4 bg-gray-50 p-4 rounded-md">
    <h3 class="text-sm font-medium text-gray-700 mb-2">Définitions</h3>
    <ul class="text-xs text-gray-600 space-y-1">
      <li><strong>Taux d'activité :</strong> Proportion de femmes de 15 à 64 ans qui sont actives (en emploi ou au chômage)</li>
      <li><strong>Taux d'emploi :</strong> Proportion de femmes de 15 à 64 ans qui sont en emploi</li>
      <li><strong>Taux de temps partiel :</strong> Proportion de femmes en emploi qui travaillent à temps partiel</li>
    </ul>
  </div>
</div>
